# ============================================================================
# Problem Frames Specification: {FEATURE_NAME}
# ============================================================================
# Generated by: analyze-frame
# Frame Type: CommandedBehaviorFrame | InformationDisplayFrame | RequiredBehaviorFrame
# ============================================================================

problem_frame: "{FeatureName}"
frame_type: CommandedBehaviorFrame  # CommandedBehaviorFrame | InformationDisplayFrame | RequiredBehaviorFrame | WorkpiecesFrame | TransformationFrame

intent: |
  When a {Operator} {action},
  the Machine shall {expected behavior},
  and {outcome}.

# ============================================================================
# Problem Frame Components
# ============================================================================

operator:
  name: "{OperatorName}"
  description: |
    {描述 Operator 的角色和職責}

machine:
  name: "{FeatureName}Machine"
  machine_spec: machine/machine.yaml

controlled_domain:
  domain: "{DomainName}"
  entity: "{AggregateRoot} (Aggregate Root)"
  aggregate_spec: controlled-domain/aggregate.yaml

# ============================================================================
# Frame Concerns（問題框架關注點）
# ============================================================================
# 
# Frame Concerns 是這個問題框架需要解決的關鍵關注點。
# 每個 Frame Concern 必須有 satisfied_by 連結，指向實作它的規格或測試。
# 
# 常見的 Frame Concerns:
# - Structure Integrity: 資料結構的完整性約束
# - Concurrency: 並發處理和競爭條件
# - Consistency: 資料一致性要求
# - Authorization: 授權和權限控制
# - Validation: 輸入驗證規則
# - Idempotency: 冪等性要求
# ============================================================================

frame_concerns:
  - id: FC1
    name: "{Concern Name}"
    description: |
      {描述這個關注點}
      {為什麼這個關注點重要}
      {違反時會發生什麼}
    satisfied_by:
      - controlled-domain/aggregate.yaml#invariants.shared.{invariant-id}
      - tests#{test-id}

  - id: FC2
    name: "Interference / Concurrency"
    description: |
      Multiple users may concurrently perform this operation.
      The Machine must avoid inconsistent results or violating constraints.
    satisfied_by:
      - machine/use-case.yaml#transaction_boundary
      - machine/use-case.yaml#idempotency
      - tests#concurrency

# ============================================================================
# Cross-Context Dependencies（跨限界上下文依賴）
# ============================================================================
# 
# 當這個功能需要依賴其他 Bounded Context 的服務時，在此定義。
# 每個依賴都需要對應的 ACL (Anti-Corruption Layer) 規格。
# 
# 常見的跨 BC 依賴:
# - Authorization: 權限檢查 (AccessControl BC)
# - UserInfo: 使用者資訊 (UserManagement BC)
# - Payment: 付款處理 (Payment BC)
# - Notification: 通知發送 (Notification BC)
# ============================================================================

cross_context_dependencies:
  # 如果沒有跨 BC 依賴，可以留空或移除此區塊
  - id: XC1
    name: "Authorization"
    source_context: "AccessControl"
    target_context: "{CurrentBC}"
    interface_type: "AntiCorruptionLayer"
    contract_spec: cross-context/authorization.yaml
    description: |
      Check if the operator has permission to perform this action.

# ============================================================================
# Generation Metadata（生成元數據）
# ============================================================================

generation:
  version: "1.0.0"
  created_at: "{ISO-8601-TIMESTAMP}"
  last_generated: null
  
  # 版本歷史記錄
  history: []
  
  # 程式碼輸出路徑
  output_paths:
    application: "src/application/use-cases/"
    domain: "src/domain/"
    infrastructure: "src/infrastructure/"
